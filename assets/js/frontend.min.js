(function () { "use strict"; var disabledForms = {}; function disableFormAfterSubmit(wpcf7Container) { if (!wpcf7Container) return; var containerId = wpcf7Container.id || wpcf7Container.getAttribute("data-wpcf7-id") || ""; if (disabledForms[containerId]) return; var formElement = wpcf7Container.querySelector("form.wpcf7-form"); if (formElement) { disabledForms[containerId] = true; wpcf7Container.classList.add("we-disabled"); var submitButtons = formElement.querySelectorAll('input[type="submit"], button[type="submit"]'); submitButtons.forEach(function (button) { button.style.display = "none" }); var fields = formElement.querySelectorAll("input, textarea, select"); fields.forEach(function (field) { var fieldType = (field.type || "").toLowerCase(); var tagName = field.tagName.toUpperCase(); if (fieldType === "hidden") return; if (fieldType === "submit" || fieldType === "button") return; if (fieldType === "text" || fieldType === "email" || fieldType === "tel" || fieldType === "url" || fieldType === "number" || fieldType === "date" || fieldType === "time" || fieldType === "datetime-local" || fieldType === "month" || fieldType === "week" || tagName === "TEXTAREA") { field.readOnly = true; field.setAttribute("readonly", "readonly"); field.setAttribute("tabindex", "-1"); field.style.pointerEvents = "none" } else if (tagName === "SELECT" || fieldType === "checkbox" || fieldType === "radio" || fieldType === "file" || fieldType === "color") { field.disabled = true; field.setAttribute("disabled", "disabled"); field.setAttribute("tabindex", "-1"); field.style.pointerEvents = "none" } else { field.readOnly = true; field.setAttribute("readonly", "readonly"); field.setAttribute("tabindex", "-1"); field.style.pointerEvents = "none" } field.addEventListener("focus", function (e) { e.preventDefault(); e.stopPropagation(); this.blur() }, true); field.addEventListener("click", function (e) { if (this.readOnly || this.disabled) { e.preventDefault(); e.stopPropagation() } }, true); field.addEventListener("mousedown", function (e) { if (this.readOnly || this.disabled) { e.preventDefault(); e.stopPropagation() } }, true) }) } } function checkAndDisableForm(container) { if (!container) return; var formElement = container.querySelector("form.wpcf7-form"); if (!formElement) return; var formStatus = formElement.getAttribute("data-status"); var hasFormStatus = formStatus === "sent" || formStatus === "aborted" || formElement.classList.contains("sent") || formElement.classList.contains("aborted"); var responseOutput = container.querySelector(".wpcf7-response-output"); var screenReaderResponse = container.querySelector(".screen-reader-response p"); var hasResponse = false; if (responseOutput && responseOutput.textContent.trim() !== "") hasResponse = true; if (screenReaderResponse && screenReaderResponse.textContent.trim() !== "") hasResponse = true; if (hasFormStatus || hasResponse) disableFormAfterSubmit(container) } function getCf7Container(target) { var container = target.closest(".wpcf7"); if (!container) container = target; return container } function init() { document.addEventListener("wpcf7mailsent", function (event) { var wpcf7Container = getCf7Container(event.target); if (wpcf7Container) setTimeout(function () { disableFormAfterSubmit(wpcf7Container) }, 100) }, false); document.addEventListener("wpcf7mailfailed", function (event) { var wpcf7Container = getCf7Container(event.target); if (wpcf7Container) setTimeout(function () { disableFormAfterSubmit(wpcf7Container) }, 100) }, false); document.addEventListener("wpcf7submit", function (event) { var unitTag = event.detail ? event.detail.unitTag : null; if (unitTag) { var wpcf7Container = document.getElementById(unitTag); if (!wpcf7Container) wpcf7Container = document.querySelector("." + unitTag); if (!wpcf7Container) { var formId = unitTag.replace(/^wpcf7-f/, "").replace(/-p\d+$/g, ""); var element = document.querySelector('[data-wpcf7-id="' + formId + '"]'); if (element) wpcf7Container = element.closest(".wpcf7") } if (wpcf7Container) setTimeout(function () { checkAndDisableForm(wpcf7Container) }, 500) } }, false); var observer = new MutationObserver(function (mutations) { mutations.forEach(function (mutation) { if (mutation.addedNodes.length) { mutation.addedNodes.forEach(function (node) { if (node.nodeType === 1) { var isResponse = node.classList && (node.classList.contains("wpcf7-response-output") || node.classList.contains("screen-reader-response") || node.querySelector(".wpcf7-response-output") !== null || node.querySelector(".screen-reader-response") !== null); if (isResponse) { var wpcf7Container = node.closest(".wpcf7"); if (wpcf7Container) setTimeout(function () { checkAndDisableForm(wpcf7Container) }, 500) } } }) } if (mutation.type === "attributes" && mutation.attributeName === "data-status") { var target = mutation.target; if (target.classList && target.classList.contains("wpcf7-form")) { var wpcf7Container = target.closest(".wpcf7"); if (wpcf7Container) setTimeout(function () { checkAndDisableForm(wpcf7Container) }, 500) } } if (mutation.type === "attributes" && mutation.attributeName === "class") { var target = mutation.target; if (target.classList && target.classList.contains("wpcf7-form") && target.classList.contains("aborted")) { var wpcf7Container = target.closest(".wpcf7"); if (wpcf7Container) setTimeout(function () { checkAndDisableForm(wpcf7Container) }, 500) } } }) }); var cf7Forms = document.querySelectorAll(".wpcf7"); cf7Forms.forEach(function (container) { observer.observe(container, { childList: true, subtree: true, attributes: true, attributeFilter: ["class", "data-status"] }); setTimeout(function () { checkAndDisableForm(container) }, 1000) }) } if (document.readyState === "loading") document.addEventListener("DOMContentLoaded", init); else init() })();

